<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Геометрический Спринт</title>
    <style>
        :root {
            --primary: #2c3e50;
            --accent: #3498db;
            --success: #27ae60;
            --danger: #e74c3c;
            --bisector: #9b59b6;
            --height: #e67e22;
            --median: #2ecc71;
        }

        body { font-family: 'Segoe UI', sans-serif; background: #f0f2f5; margin: 0; display: flex; justify-content: center; align-items: center; min-height: 100vh; }
        
        .game-card { background: white; width: 600px; padding: 30px; border-radius: 20px; box-shadow: 0 10px 40px rgba(0,0,0,0.1); text-align: center; }
        
        .stats-bar { display: flex; justify-content: space-between; margin-bottom: 20px; font-weight: bold; font-size: 1.2em; }
        
        #timer { color: var(--danger); }
        #score { color: var(--success); }

        .svg-container { background: #f9f9f9; border-radius: 15px; margin-bottom: 20px; position: relative; height: 300px; }
        svg { width: 100%; height: 100%; }

        .btn-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; }
        
        .game-btn { 
            padding: 15px; border: none; border-radius: 10px; cursor: pointer; 
            font-weight: bold; color: white; transition: 0.2s; font-size: 14px;
        }
        .game-btn:active { transform: scale(0.95); }
        .btn-b { background: var(--bisector); }
        .btn-h { background: var(--height); }
        .btn-m { background: var(--median); }

        #start-screen { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(255,255,255,0.9); display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 15px; z-index: 10; }
        
        .pulse { animation: pulse-animation 2s infinite; }
        @keyframes pulse-animation { 0% { transform: scale(1); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }

        /* Геометрические стили */
        .shape { fill: rgba(52, 152, 219, 0.05); stroke: var(--primary); stroke-width: 2; }
        .line-active { stroke: #7f8c8d; stroke-width: 2; stroke-dasharray: 4; }
        .marker { stroke-width: 2; fill: none; }
    </style>
</head>
<body>

<div class="game-card">
    <div class="stats-bar">
        <span>Счет: <span id="scoreVal">0</span></span>
        <span id="timer">Время: 30</span>
    </div>

    <div class="svg-container">
        <div id="start-screen">
            <h3>Финальный Босс: Спринт</h3>
            <p>Определи тип линии по чертежу за 30 секунд!</p>
            <button class="game-btn btn-b pulse" onclick="startGame()" style="padding: 15px 40px; font-size: 18px;">ПОЕХАЛИ!</button>
        </div>
        
        <svg id="gameSvg" viewBox="0 0 400 300">
            <path id="tri" class="shape" d="" />
            <line id="centralLine" class="line-active" x1="0" y1="0" x2="0" y2="0" />
            <g id="markersGroup"></g>
        </svg>
    </div>

    <div class="btn-grid">
        <button class="game-btn btn-b" onclick="checkAnswer('bisector')">БИССЕКТРИСА</button>
        <button class="game-btn btn-h" onclick="checkAnswer('height')">ВЫСОТА</button>
        <button class="game-btn btn-m" onclick="checkAnswer('median')">МЕДИАНА</button>
    </div>
</div>

<script>
    let score = 0;
    let timeLeft = 30;
    let gameActive = false;
    let currentType = '';
    let timerId;

    const types = ['bisector', 'height', 'median'];

    function startGame() {
        score = 0;
        timeLeft = 30;
        gameActive = true;
        document.getElementById('start-screen').style.display = 'none';
        document.getElementById('scoreVal').textContent = score;
        nextQuestion();
        
        timerId = setInterval(() => {
            timeLeft--;
            document.getElementById('timer').textContent = `Время: ${timeLeft}`;
            if (timeLeft <= 0) endGame();
        }, 1000);
    }

    function nextQuestion() {
        currentType = types[Math.floor(Math.random() * types.length)];
        drawTriangle();
    }

    function drawTriangle() {
        const svg = document.getElementById('gameSvg');
        const markers = document.getElementById('markersGroup');
        markers.innerHTML = '';
        
        // Рандомизируем размеры треугольника для сложности
        const baseWidth = 150 + Math.random() * 150;
        const height = 100 + Math.random() * 100;
        const centerX = 200;
        const centerY = 250;
        const topY = centerY - height;

        const xA = centerX - baseWidth/2;
        const xC = centerX + baseWidth/2;

        document.getElementById('tri').setAttribute('d', `M${centerX},${topY} L${xA},${centerY} L${xC},${centerY} Z`);
        document.getElementById('centralLine').setAttribute('x1', centerX);
        document.getElementById('centralLine').setAttribute('y1', topY);
        document.getElementById('centralLine').setAttribute('x2', centerX);
        document.getElementById('centralLine').setAttribute('y2', centerY);

        // Рисуем маркеры в зависимости от типа
        if (currentType === 'bisector') {
            markers.innerHTML = `
                <path class="marker" d="M${centerX-10},${topY+20} A15,15 0 0 1 ${centerX},${topY+20}" stroke="var(--bisector)"/>
                <path class="marker" d="M${centerX},${topY+20} A15,15 0 0 1 ${centerX+10},${topY+20}" stroke="var(--bisector)"/>
            `;
        } else if (currentType === 'height') {
            markers.innerHTML = `<polyline class="marker" points="${centerX-15},${centerY} ${centerX-15},${centerY-15} ${centerX},${centerY-15}" stroke="var(--height)"/>`;
        } else if (currentType === 'median') {
            markers.innerHTML = `
                <line class="marker" x1="${(xA+centerX)/2}" y1="${centerY-5}" x2="${(xA+centerX)/2 + 5}" y2="${centerY+5}" stroke="var(--median)"/>
                <line class="marker" x1="${(xC+centerX)/2 - 5}" y1="${centerY-5}" x2="${(xC+centerX)/2}" y2="${centerY+5}" stroke="var(--median)"/>
            `;
        }
    }

    function checkAnswer(choice) {
        if (!gameActive) return;

        if (choice === currentType) {
            score += 10;
            document.getElementById('scoreVal').textContent = score;
            // Короткая вспышка зеленым
            document.querySelector('.svg-container').style.background = '#eaffea';
        } else {
            timeLeft -= 3; // Штраф за ошибку
            document.querySelector('.svg-container').style.background = '#ffeaea';
        }
        
        setTimeout(() => {
            document.querySelector('.svg-container').style.background = '#f9f9f9';
            nextQuestion();
        }, 200);
    }

    function endGame() {
        gameActive = false;
        clearInterval(timerId);
        const screen = document.getElementById('start-screen');
        screen.style.display = 'flex';
        screen.innerHTML = `
            <h2>ВРЕМЯ ВЫШЛО!</h2>
            <p style="font-size: 24px">Твой результат: <b>${score}</b></p>
            <button class="game-btn btn-b" onclick="startGame()" style="padding: 10px 30px;">ЕЩЁ РАЗ</button>
        `;
    }
</script>

</body>
</html>
